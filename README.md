# LogerOwin

1) Открыть проект в VS, откомпилировать в режиме Debug 
   Теперь необходимо проинсталировать сервис и запустить. Инсталировать можно при помощи самого исполняемого 
   файла OwinSelfHost.exe. Запустите следующие команды, (с правами администратора) букву диска указать свою.

   X :\Owin_Pisetskij\bin\Debug\OwinSelfHost.exe install
   X :\Owin_Pisetskij\bin\Debug\OwinSelfHost.exe Start

   В списке служб должна появиться служба Display name   --->  !OWIN Self Host
   /*
   OwinSelfHost.exe install             Инсталяция сервиса 
   OwinSelfHost.exe start               Пуск службы
   OwinSelfHost.exe stop                Останов службы 
   OwinSelfHost.exe uninstall           Удаление сервиса из списка
   */

>> Запускаться в debug кнопкой  "start" без дополнительных манипуляций;
  После инсталяции службу можно будет запускать и останавливать по кнопке без дополнительных манипуляций.
  

>> 2) Добавить Apicontroller "StatusController" в нем метод bool CheckStatus который будет отвечать true если сервис запущен;

   Реализованно смотреть по  http://localhost:8080/api/Status/CheckStatus

>> 3) Необходимо написать модуль "опросник статуса сайтов", который позволит опрашивать сайты google.com, Microsoft.com, apple.com
>> на доступность по расписанию и записывать их статусы в файл. Периодичность проверки google.com 2 минуты, apple.com 5 минут, 
>> а Microsoft каждые 2 дня в 22:15.

   Реализованно, для наглядности домен google.com проверяю каждые 4 сек. (По ТЗ поставил бы конечно 120 сек.)
   Файл записываю на диск С:\templog.txt (если права есть)

Start....
time: 30.04.2017 19:46:28, status: OK, hostname: google.com
time: 30.04.2017 19:46:32, status: OK, hostname: google.com
time: 30.04.2017 19:46:36, status: OK, hostname: google.com
time: 30.04.2017 19:46:40, status: OK, hostname: google.com
time: 30.04.2017 19:46:44, status: OK, hostname: google.com


>> 1)Описан план выполнения задачи
   Создаем новый проект  C# Console-Application
   добавляем в проект Topshelf через NuGet-Packages
   с помощью него мы будем консольное приложение запускать на исполнение в виде Windows Service
   Добовляем пакеты Microsoft OWIN
   Добовляем файл/класс Strtup.cs где конфигурируем OWIN  и указываем шаблон маршрутизации.

   Добавим через NuGet библиотеку Microsoft.Owin.SelfHost в качестве веб-сервера мы будем использовать
   класс HttpListener, который может прослушивать входящие http-запросы и отвечать на них.

   Добавляем файл/класс контроллера, который будет обрабатывать WEB API запросы и подготавливать ответ.


   Добовляем файл/класс OwinServicervice в котором реализуем методы Start/Stop для работы службы.
   
   В классе Logger.cs реализована логика работы опросника. 
   В файле LoggerModule.sc реализован модуль Owin middlware 
   который можно подключать к Owin приложению. Также там создаем экземпляр класса Logger
   В классе определены 3 таймера которые отмеряют приод времени между опросами статуса сайтов. 

   В файле Logger.cs релизован класс логера который будет выполнять GET-запросы на заданные доменные имена
   с заданной периодичностью. Результаты будем записывать в файл C:\templog.txt
